import{a as M,m as B,n as h,d as k,r as i,e as f,f as s,h as g,l as A,F as x,G as W,o as d,t as E,y as P,z as G,_ as R,p as z,N as H,H as $,I as S,g as L,i as I,L as J,M as K,J as j}from"./index-896a6a3c.js";import{_ as y}from"./CustomInput.vue_vue_type_script_setup_true_lang-21dea55c.js";import{u as O}from"./useGetArticle-7ebd40d4.js";function X(){return M({mutationFn:B.post})}function Y(o,a){return M({mutationFn:({title:e,description:l,body:t,tagList:p})=>B.putBySlug(a.value,{title:e,description:l,body:t,tagList:p}),onMutate:async({title:e,description:l,body:t,tagList:p})=>{await o.cancelQueries(h.article.slug(a));const m=o.getQueryData(h.article.slug(a));return m&&o.setQueryData(h.article.slug(a),n=>({...n,title:e,description:l,body:t,tagList:p})),{prevData:m}},onError:(e,l,t)=>{t&&o.setQueryData(h.article.slug(a),t.prevData)},onSettled:()=>{o.invalidateQueries(h.lists.all),o.invalidateQueries(h.article.slug(a))}})}const Z=o=>(P("data-v-833769b9"),o=o(),G(),o),q=["onSubmit"],tt={class:"tag-list"},et=["onClick"],st=Z(()=>s("i",{class:"ion-close-round"},null,-1)),at=k({__name:"TagForm",props:{tags:{}},emits:["update:tags"],setup(o,{emit:a}){const e=i([]),l=i("");function t(){e.value=[...new Set([...e.value,l.value])],a("update:tags",e.value),l.value=""}function p(m){e.value=e.value.filter(n=>n!==m),console.log(e.value)}return(m,n)=>(d(),f(x,null,[s("form",{class:"form-group",onSubmit:A(t,["prevent"])},[g(y,{type:"text",class:"form-control",placeholder:"Enter tags",value:l.value,"onUpdate:value":n[0]||(n[0]=u=>l.value=u)},null,8,["value"])],40,q),s("div",tt,[(d(!0),f(x,null,W(e.value,u=>(d(),f("button",{key:u,class:"tag-default tag-pill tag-button",onClick:()=>p(u)},[st,s("span",null,E(u),1)],8,et))),128))])],64))}});const C=R(at,[["__scopeId","data-v-833769b9"]]),lt={key:0,class:"error-messages"},ot=["onSubmit"],nt=s("fieldset",{class:"form-group"},null,-1),ut={class:"form-group"},rt=s("fieldset",{class:"form-group"},null,-1),it=s("button",{class:"btn btn-lg pull-xs-right btn-primary",type:"submit"},"Edit Article",-1),ct=k({__name:"EditorForm",props:{slug:{}},setup(o){var F,U,D,Q;const{slug:a}=o,e=z(),l=i(a),{data:t,isLoading:p,isError:m}=O(l),n=i(((F=t.value)==null?void 0:F.title)??""),u=i(((U=t.value)==null?void 0:U.description)??""),r=i(((D=t.value)==null?void 0:D.body)??""),c=i([...((Q=t.value)==null?void 0:Q.tagList)??[]]),w=i(""),{mutateAsync:N}=Y(e,l);async function V(){try{await N({title:n.value,description:u.value,body:r.value,tagList:c.value}),I.push(`/article/${a}`)}catch(b){w.value=b}}return H(t,()=>{var b,v,_,T;n.value=((b=t.value)==null?void 0:b.title)??"",u.value=((v=t.value)==null?void 0:v.description)??"",r.value=((_=t.value)==null?void 0:_.body)??"",c.value=[...((T=t.value)==null?void 0:T.tagList)??[]]}),(b,v)=>$(p)?(d(),S(J,{key:0})):$(m)?(d(),S(K,{key:1})):$(t)?(d(),f(x,{key:2},[w.value.length>0?(d(),f("ul",lt,[s("li",null,E(w.value),1)])):L("",!0),s("form",{onSubmit:A(V,["prevent"])},[g(y,{type:"text",class:"form-control form-control-lg",placeholder:"Article Title",value:n.value,"onUpdate:value":v[0]||(v[0]=_=>n.value=_)},null,8,["value"]),nt,s("fieldset",ut,[g(y,{type:"text",class:"form-control",placeholder:"What's this article about?",value:u.value,"onUpdate:value":v[1]||(v[1]=_=>u.value=_)},null,8,["value"])]),g(y,{"is-text-area":"",class:"form-control",rows:"8",placeholder:"Write your article (in markdown)",value:r.value,"onUpdate:value":v[2]||(v[2]=_=>r.value=_)},null,8,["value"]),rt,g(C,{tags:c.value,"onUpdate:tags":v[3]||(v[3]=_=>c.value=_)},null,8,["tags"]),it],40,ot)],64)):L("",!0)}}),dt={key:0,class:"error-messages"},pt=["onSubmit"],vt=s("fieldset",{class:"form-group"},null,-1),_t={class:"form-group"},mt=s("fieldset",{class:"form-group"},null,-1),gt=s("button",{class:"btn btn-lg pull-xs-right btn-primary",type:"submit"},"Publish Article",-1),ft=k({__name:"CreateForm",setup(o){const a=i(""),e=i(""),l=i(""),t=i([]),p=i(""),{mutateAsync:m}=X();async function n(){try{await m({title:a.value,description:e.value,body:l.value,tagList:t.value}),I.push("/")}catch(u){p.value=u}}return(u,r)=>(d(),f(x,null,[p.value.length>0?(d(),f("ul",dt,[s("li",null,E(p.value),1)])):L("",!0),s("form",{onSubmit:A(n,["prevent"])},[g(y,{type:"text",class:"form-control form-control-lg",placeholder:"Article Title",value:a.value,"onUpdate:value":r[0]||(r[0]=c=>a.value=c)},null,8,["value"]),vt,s("fieldset",_t,[g(y,{type:"text",class:"form-control",placeholder:"What's this article about?",value:e.value,"onUpdate:value":r[1]||(r[1]=c=>e.value=c)},null,8,["value"])]),g(y,{"is-text-area":"",class:"form-control",rows:"8",placeholder:"Write your article (in markdown)",value:l.value,"onUpdate:value":r[2]||(r[2]=c=>l.value=c)},null,8,["value"]),mt,g(C,{tags:t.value,"onUpdate:tags":r[3]||(r[3]=c=>t.value=c)},null,8,["tags"]),gt],40,pt)],64))}}),yt={class:"editor - page"},ht={class:"container page"},bt={class:"row"},$t={class:"col-md-10 offset-md-1 col-xs-12"},wt=k({__name:"EditorView",setup(o){const a=j();return(e,l)=>(d(),f("div",yt,[s("div",ht,[s("div",bt,[s("div",$t,[$(a).path.split("/")[2]?(d(),S(ct,{key:0,slug:$(a).path.split("/")[2]},null,8,["slug"])):(d(),S(ft,{key:1}))])])])]))}});export{wt as default};
